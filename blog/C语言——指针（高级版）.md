# C语言——指针（高级版）

## 重点内容：

##### 1.字符指针

##### 2.数组指针

##### 3.指针数组

##### 4.数组传参和指针传参

##### 5.函数指针

## 前序：什么是指针？

虽然大家可能都知道什么是指针，但是为了让大家更好理解，我还是再把指针的概念讲一下。

1.指针它其实并没有很神秘，它就是一个变量，用来存放地址，地址唯一且标识一块内存空间。所以我们能够运用指针来查找你想要的数据。

举个栗子：李狗蛋家住在陕西省西安市临潼区陕鼓大道50号，住在西安科技大学旁边，然后狗蛋的同学二狗子放假想来狗蛋家里玩，狗蛋把地址写在纸上给了二狗子，二狗子来到了狗蛋家。

这里只是一个例子，便于理解，我们可以发现那张纸条就是我们这里讲的指针，纸条上面有狗蛋家的详细地址（指针存放地址），通过纸条二狗子找到了狗蛋家（解引用），这就是指针的概念。

2.指针它是有大小的，一般占4个字节（byte），这是在32位平台。64位平台，指针占8个字节（byte）。

3.指针是有类型的，指针的类型决定了指针+-整数的步长，指针解引用操作的时候的权限。

4.指针是可以进行运算的。

好了，指针就讲完了，然后让我们进入正题。

## 1.字符指针

字符我们应该不陌生了，学过C语言的应该都知道，就是char类型的数据，不过我要讲的是char*；

这个叫做字符指针。

常见的使用方式：

```c
int main
{
    char ch = 'a';//这里定义一个字符变量ch,存放一个字符a
    char *pc = &ch;//定义一个（字符）指针，存放字符变量ch的地址
    *pc = 'a'; //对pc解引用找到字符a
    return 0;
}
```

可以看到，这个代码非常简单，结合我们讲的指针的概念和刚才的例子，代入进去就很清晰了。

那接下来我们看一个不一样的（另一种使用方式）：

```c
int main()
{
    const char* pstr = "hello world.";//这里需要思考，一个字符串能存进去吗？
    printf("%s\n",pstr);
    return 0;
}
```

这里有些人就感觉，这不是把字符串存进去了吗？

当然不是，我们可以来看一下运行结果：![image-20230227203513587](C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227203513587.png)

好家伙，这是怎么回事，难道讲错了，其实并没有讲错哈，这里指针的第二条性质我们也知道，它在32位平台下面是4个字节大小，所以不能存放这么多字符，那为什么会显示这个字符串呢？

指针里面存放的应该是字符串的首字符，这个字符串首字符是h。然后printf函数它要遇到\0才会结束，所以我们代码显示的是整个字符串。

理解了这个，我们可以看一下接下来的一个面试题：（可以试着先思考一下）

```c
#include <stdio.h>
int main()
{
    char str1[] = "hello world.";
    char str2[] = "hello world.";
    const char *str3 = "hello world.";
    const char *str4 = "hello world.";
    if(str1 == str2)
        printf("str1 and str2 are same\n");
    else
        printf("str1 and str2 are not same\n");
    if(str3 == str4)
        printf("str3 and str4 are same\n");
    else
        printf("str3 and str4 are not same\n");
    return 0;
}
```

和我上面讲的很相似，字符串1和字符串2它们是两个独立开辟的空间，所以它们首字符的地址是不一样的；然而字符串3和字符串实际上指向的是同一块内存（c/c++都会把字符串单独存放在一个单独的区域，当有多个指针指向同一个字符串，实际上是指向同一块内存空间）。但是用相同的字符串去初始化同一个字符时，不同数组就会开辟不同的内存块。这就是str1和str2不同的原因（下面有相关的图示）。

<img src="C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227210836946.png" alt="image-20230227210836946" style="zoom: 50%;" />

![image-20230227212014132](C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227212014132.png)

![image-20230227213640075](C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227213640075.png)

## 2.指针数组

指针数组，顾名思义就是存放指针的数组，这个数组里面存放的是指针，下面放一个图助于理解：

![image-20230227214018045](C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227214018045.png)

```c
int* arr1[10]; //整形指针的数组
char *arr2[4]; //一级字符指针的数组
char **arr3[5];//二级字符指针的数组
```

这里很简单哈，我们看第一个arr1，它先和[10]相结合，所以它是一个数组，然后它又和int*结合，这说明它存放的是整型指针的数据，存放指针的数组，就是指针数组了；

接下来看arr2，它同样先和[4]先结合，说明它是一个数组，接下来它和char*结合，说明存放的是一级字符指针的数组，这个就是一级字符指针数组，也属于指针数组。

最后看一下arr3，它同样先和[5]先结合，说明它是一个数组，然后它和char**结合，说明存放的数据类型是二级字符指针，这个就是二级字符指针的数组，同样也是指针数组。

## 3.数组指针

### 3.1数组指针的定义

呕吼，这里彻底懵了，这是指针还是数组啊？？？

答案是：指针。

我们应该已经了解了很多种指针：

整型指针：int * p ;指向整型数据的指针。

浮点型指针: float  * p;指向浮点型数据的指针。

字符指针：char* ch;指向字符型数据的指针。

那数组指针自然是：能够指向数组的指针。

下面哪个代码是数组指针?

```c
int *p1[10];
int (*p2)[10];
//p1, p2分别是什么？
```

p1很简单，我们上面讲过，p1先和[10]结合，说明它是数组，然后再和int*结合，说明存放的数据类型是整型指针，所以它是指针数组。

p2我们来仔细看一下，首先有括号，括号的优先级是比较高的，所以p2先和*结合，说明它是指针变量，然后指向一个大小为10个整型的数组，一个指针指向一个数组，称为数组指针。

注意：[]的优先级要高于*号的，所以必须加上（）来先保证p和星号先结合。

### 3.2&数组名VS数组名

```c
int arr[10]；
```

我们经常会使用数组，但是arr和&arr的区别是什么呢？

我们知道arr是数组名，数组名表示的是数组中首元素的地址。

那&arr中的数组名是什么呢？

我这里有一段代码，我们来看一下：

```c
#include <stdio.h>
int main()
{
int arr[10] = {0};
printf("%p\n", arr);
printf("%p\n", &arr);
return 0;
}
```

<img src="C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227231846770.png" alt="image-20230227231846770" style="zoom:67%;" />

运行后我们会发现，数组名和&数组名打印的地址是一样的。

思考：所以它们两个是一样的吗？

再来看一段代码：

```c
#include <stdio.h>
int main()
{
int arr[10] = { 0 };
printf("arr = %p\n", arr);
printf("&arr= %p\n", &arr);
printf("arr+1 = %p\n", arr+1);
printf("&arr+1= %p\n", &arr+1);
return 0;
}
```

![image-20230227232246615](C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227232246615.png)

好，这次我们发现arr+1和&arr+1它们的结果不一样，我们来分析一下：

|    arr     | 009AFA90     |
| :--------: | ------------ |
| **arr+1**  | **009AFA94** |
|  **&arr**  | **009AFA90** |
| **&arr+1** | **009AFAB8** |

![image-20230227234858329](C:\Users\ZZF\AppData\Roaming\Typora\typora-user-images\image-20230227234858329.png)

我们通过比可以知道，arr和arr+1相差4个字节，也就是一个整型的大小。

而&arr和&arr+1相差0x28,十六进制的28转换成2*16^1+8^0=32+8=40byte。

所以根据代码我们可知，其实arr和&arr的值是一样的，但是它们的意义是不一样的。

**实际上：**`&arr`表示的是**整个数组的地址**，而不是数组首元素的地址。

毕竟`arr+1`是跳过一个整型大小的数据，4个字节；而`&arr+1`跳过整个数组，40个字节。

本例中`&arr`的类型是：`int(*)[10]`,是一种数组指针类型。

### 3.3数组指针的使用





